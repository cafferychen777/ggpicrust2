% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pathway_daa.R
\name{pathway_daa}
\alias{pathway_daa}
\title{Differential Abundance Analysis for Predicted Functional Pathways}
\usage{
pathway_daa(
  abundance,
  metadata,
  group,
  daa_method = "ALDEx2",
  select = NULL,
  p.adjust = "BH",
  reference = NULL,
  include_abundance_stats = FALSE,
  ...
)
}
\arguments{
\item{abundance}{A data frame or matrix containing predicted functional pathway abundance,
with pathways/features as rows and samples as columns.
The column names should match the sample names in metadata.
Values should be counts or abundance measurements.}

\item{metadata}{A data frame or tibble containing sample information.
Must include a 'sample' column with sample identifiers matching the column names in abundance data.}

\item{group}{Character string specifying the column name in metadata that contains group information
for differential abundance analysis.}

\item{daa_method}{Character string specifying the method for differential abundance analysis.
Available choices are:
\itemize{
\item \code{"ALDEx2"}: ANOVA-Like Differential Expression tool
\item \code{"DESeq2"}: Differential expression analysis based on negative binomial distribution
\item \code{"edgeR"}: Exact test for differences between groups using negative binomial model
\item \code{"limma voom"}: Limma-voom framework for RNA-seq analysis
\item \code{"metagenomeSeq"}: Zero-inflated Gaussian mixture model
\item \code{"LinDA"}: Linear models for differential abundance analysis
\item \code{"Maaslin2"}: Multivariate Association with Linear Models
\item \code{"Lefser"}: Linear discriminant analysis Effect Size
}
Default is "ALDEx2".}

\item{select}{Character vector of sample names to include in the analysis.
If NULL (default), all samples in the abundance data are used.}

\item{p.adjust}{Character string specifying the method for multiple testing correction.
Options include "BH" (Benjamini-Hochberg), "bonferroni", "holm", etc.
Default is "BH".}

\item{reference}{Character string specifying the reference group for comparison.
Only used for methods that support multi-group comparisons (LinDA, limma voom, Maaslin2).
If NULL, the first level of the group factor is used as reference.}

\item{include_abundance_stats}{Logical value indicating whether to include 
abundance statistics (mean relative abundance, standard deviation, 
and log2 fold change) in the output. Default is FALSE for backward 
compatibility.}

\item{...}{Additional arguments passed to the specific DAA method.}
}
\value{
A data frame containing the differential abundance analysis results. The structure of the results
depends on the chosen DAA method. For methods that support multi-group comparisons (like LinDA),
when there are more than two groups, the results will contain separate rows for each feature in each
pairwise comparison between the reference group and each non-reference group. The data frame includes
the following columns:
\itemize{
\item \code{feature}: Feature/pathway identifier
\item \code{method}: The DAA method used
\item \code{group1}: Reference group
\item \code{group2}: Comparison group
\item \code{p_values}: P-values for the comparison
\item \code{p_adjust}: Adjusted p-values
\item \code{adj_method}: Method used for p-value adjustment
}

When \code{include_abundance_stats = TRUE}, the following additional columns 
are included:
\itemize{
\item \code{mean_rel_abundance_group1}: Mean relative abundance for group1
\item \code{sd_rel_abundance_group1}: Standard deviation of relative 
abundance for group1
\item \code{mean_rel_abundance_group2}: Mean relative abundance for group2
\item \code{sd_rel_abundance_group2}: Standard deviation of relative 
abundance for group2
\item \code{log2_fold_change}: Log2 fold change (group2/group1)
}

Some methods may provide additional columns, such as \code{log2FoldChange} 
for effect size information.
}
\description{
Performs differential abundance analysis on predicted functional pathway data using various statistical methods.
This function supports multiple methods for analyzing differences in pathway abundance between groups,
including popular approaches like ALDEx2, DESeq2, edgeR, and others.
}
\examples{
\donttest{
# Load example data
data(ko_abundance)
data(metadata)

# Prepare abundance data
abundance_data <- as.data.frame(ko_abundance)
rownames(abundance_data) <- abundance_data[, "#NAME"]
abundance_data <- abundance_data[, -1]

# Run differential abundance analysis using ALDEx2
results <- pathway_daa(
  abundance = abundance_data,
  metadata = metadata,
  group = "Environment"
)

# Include abundance statistics
results_with_stats <- pathway_daa(
  abundance = abundance_data,
  metadata = metadata,
  group = "Environment",
  include_abundance_stats = TRUE
)

# Using a different method (DESeq2)
deseq_results <- pathway_daa(
  abundance = abundance_data,
  metadata = metadata,
  group = "Environment",
  daa_method = "DESeq2"
)
}
}
